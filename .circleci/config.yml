version: 2
jobs:
  ensure_branch:
    docker:
      - image: skywayci/skyway-js-sdk
    steps:
      - checkout
      #TODO: should install in docker-image
      - run:
          name: Install extra deps for CI
          command: npm install @octokit/rest
      - run: node ./scripts/ensure-branch.js
  test:
    docker:
      - image: skywayci/skyway-js-sdk
    steps:
      - run: echo "Success ;D"
      # - checkout
      # - run: npm install
      # - run: npm run lint
      # - run: npm run test

workflows:
  version: 2
  test_and_deploy:
    jobs:
      - ensure_branch
      - test:
          requires:
            - ensure_branch

